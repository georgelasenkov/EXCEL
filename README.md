<h1 align="center">EXCEL</h1>
<h2 align="center">Работаем со знакомыми уже нам таблицами из раздела по SQL (vehicles, brands, customers)</h2>

### 1️⃣ ЕСЛИ (IF)
Допустим что мы хотим установить скидку 3% на все автомобили, пробег которых превышает 100 000 км, в этом нам поможет функция ЕСЛИ.
Создадим новый столбец между столбцами price и mileage, назовем его sale_price.
Во вторую строку нового столбца запишем формулу:  
#### <h3 align="center">``` =ЕСЛИ(I2>100000;G2*0,97;G2) ```</h3>  
где:  
- I2>100000 - условие поиска (цена более 100000)  
- G2*0,97 - действие, если условие выполнено (снижаем цену на 3%)  
- G2 - действие, если условие не выполнено (просто возвращаем обычную цену без скидки)

Применяем формулу, двойным кликом по маркеру автозаполнения применим эту формулу ко всем остальным ячейкам в столбце.
Результат:
<h3 align="center"><img src="https://github.com/georgelasenkov/EXCEL/blob/main/if.png"></h3>

### 2️⃣ СУММЕСЛИ (SUMIF)
Нужно сосчитать общую стоимость всех машин черного цвета.
Формула будет выглядеть так:  
#### <h3 align="center">``` =СУММЕСЛИ(I2:I77;I2;G2:G77) ```</h3>  
где:  
- I2:I77 - диапазон поиска (столбец с цветами машин)
- I2 - критерий поиска (black)
- G2:G77 - диапазон суммирования ячеек, удовлетворяющих критерию

Результат: 672360  
<h3 align="center"><img src="https://github.com/georgelasenkov/EXCEL/blob/main/sumif.png"></h3>

### 3️⃣ СУММЕСЛИМН (SUMIFS)
Посчитать общую стоимость всех хэтчбеков с автоматической трансмиссией.
Формула:  
#### <h3 align="center">``` =СУММЕСЛИМН(G2:G77;E2:E77;E7;K2:K77;K4) ```</h3>  
- где G2:G77 - диапазон суммирования ячеек, удовлетворяющих условиям
- E2:E77 - диапазон ячеек, проверяемых на соответствие первому условию
- E7 - критерий первого условия
- K2:K77 - диапазон ячеек, проверяемых на соответствие второму условию
- K4 - критерий второго условия

Результат: 212250
<h3 align="center"><img src="https://github.com/georgelasenkov/EXCEL/blob/main/sumifs.png"></h3>

### 4️⃣ ВПР (VLOOKUP)
Для каждой модели автомобиля из таблицы vehicles добавить марку этой модели из таблицы brands. Основывать поиск будем по столбцу brand_id в таблице vehicles.  
Формула:  
#### <h3 align="center">``` =ВПР($C2;brands!$A$1:$C$23;2) ```</h3>  
- где $C2 - айди марки авто, который мы будем искать в таблице brands
- brands!$A$1:$C$23 - таблица brands, в которой будем осуществлять поиск нужного айди
- 2 - столбец в таблице brands, из которого нужно вернуть значение

Применяем формулу, двойным кликом по маркеру автозаполнения применим эту формулу ко всем остальным ячейкам в столбце.
Результат:  
<h3 align="center"><img src="https://github.com/georgelasenkov/EXCEL/blob/main/vlookup.png"></h3>

### 5️⃣ СВОДНАЯ ТАБЛИЦА (PIVOT TABLE)
Создадим сводную таблицу по нашей табличке vehicles
В колонку со строками добавим параметры body_type и model, в значения добавим параметры price и mileage.
Получится следующая табличка:  
<h3 align="center"><img src="https://github.com/georgelasenkov/EXCEL/blob/main/pivot1_1.png"></h3>  
Мы можем раскрыть любой тип кузова и посмотреть данные для конкретной модели в этом типе кузова:  
<h3 align="center"><img src="https://github.com/georgelasenkov/EXCEL/blob/main/pivot1_2.png"></h3>  
Уберем параметр model, теперь у нас в табличке осталась информация по типам кузова, их средней цене и среднему пробегу:  
<h3 align="center"><img src="https://github.com/georgelasenkov/EXCEL/blob/main/pivot2_1.png"></h3>  
Сделаем двойной клик на любой ячейке в строке hatchback - на новом листе создается новая сводная таблица со всеми моделями авто, которые принадлежат кузову хэтчбек, а также вся информация по каждой модели:  
<h3 align="center"><img src="https://github.com/georgelasenkov/EXCEL/blob/main/pivot2_2.png"></h3>  
Вверху, в названии каждого столбца есть флажок с фильтрами, выберем только бензиновые хэтчбеки в столбце типа топлива:  
<h3 align="center"><img src="https://github.com/georgelasenkov/EXCEL/blob/main/pivot2_3.png"></h3>  
